'use strict'

module.exports.abandonRequestBytes = [
  0x30, 0x06, // sequence, 6 bytes
  0x02, 0x01, 0x06, // message id (integer value "6")
  0x50, 0x01, 0x05 // abandon request protocol op (application primitive integer 5)
]

/**
 * Represents an LDAP Bind Request Message as defined by
 * RFC 4511 ยง4.2. It has a message id of "1" and attempts to bind
 * with simple authentication as user "uid=admin,ou=sys" with the password
 * "secret".
 */
module.exports.bindRequestBytes = [
  0x30, 0x25, // sequence, 37 bytes
  0x02, 0x01, 0x01, // message id (integer value "1")
  0x60, 0x20, // protocol op (0x60), 32 bytes
  0x02, 0x01, 0x03, // version (integer value "3")
  0x04, 0x13, // string, 19 bytes
  0x75, 0x69, 0x64, 0x3d, // "uid="
  0x61, 0x64, 0x6d, 0x69, 0x6e, 0x2c, // "admin,"
  0x6f, 0x75, 0x3d, 0x73, 0x79, 0x73, // "ou=sys"
  0x74, 0x65, 0x6d, // "tem"
  0x80, 0x06, // auth choice 0 ("simple"), 6 bytes
  0x73, 0x65, 0x63, 0x72, 0x65, 0x74 // "secret"
]

/**
 * Represents an anonymous bind request.
 */
module.exports.bindRequestAnonymousBytes = [
  0x30, 0x0c,
  0x02, 0x01, 0x01,
  0x60, 0x07,
  0x02, 0x01, 0x03,
  0x04, 0x00,
  0x80, 0x00
]

/**
 * Represents a delete request with controls supplied for recursive removal.
 * Taken from https://web.archive.org/web/20220629203240/https://ldap.com/ldapv3-wire-protocol-reference-ldap-message/#ldapmessage-example
 */
module.exports.deleteRequestBytes = [
  0x30, 0x35, // start sequence, 53 bytes
  0x02, 0x01, 0x05, // message id 5
  0x4a, 0x11, // delete request op (entry), 17 bytes
  0x64, 0x63, 0x3d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, // dc=exampl
  0x65, 0x2c, 0x64, 0x63, 0x3d, 0x63, 0x6f, 0x6d, // e,dc=com

  0xa0, 0x1d, // start sequence (controls), 29 bytes
  0x30, 0x1b, // start first control sequence, 27 bytes
  0x04, 0x16, 0x31, 0x2e, // control OID (octet string):
  0x32, 0x2e, 0x38, 0x34, // 1.2.840.113556.1.4.805
  0x30, 0x2e, 0x31, 0x31,
  0x33, 0x35, 0x35, 0x36,
  0x2e, 0x31, 0x2e, 0x34,
  0x2e, 0x38, 0x30, 0x35,
  0x01, 0x01, 0xff // control criticality (boolean true)
]
