'use strict'

module.exports.abandonRequestBytes = [
  0x30, 0x06, // sequence, 6 bytes
  0x02, 0x01, 0x06, // message id (integer value "6")
  0x50, 0x01, 0x05 // abandon request protocol op (application primitive integer 5)
]

/**
 * Represents a basic ADD response.
 * Taken from https://web.archive.org/web/20220630073105/https://nawilson.com/ldapv3-wire-protocol-reference-add/
 */
module.exports.addResponseBasicBytes = [
  0x30, 0x0c, // sequence, 12 bytes
  0x02, 0x01, 0x02, // message id 2
  0x69, 0x07, // add response op, 7 bytes
  0x0a, 0x01, 0x00, // success result code (enumerated value 0)
  0x04, 0x00, // no matched DN (0-byte octet string)
  0x04, 0x00 // no diagnostic message (0-byte octet string)
]

/**
 * Represents an ADD response with an error and a diagnostic message.
 * Taken from https://web.archive.org/web/20220630073105/https://nawilson.com/ldapv3-wire-protocol-reference-add/
 */
module.exports.addResponseNoSuchObjectBytes = [
  0x30, 0x81, 0x9d, // sequence, 157 bytes
  0x02, 0x01, 0x03, // message id 3
  0x69, 0x81, 0x97, // add response op, 151 bytes
  0x0a, 0x01, 0x20, // noSuchObject result code (enumerated value 32)

  0x04, 0x1d, // octet string, 29 bytes (matched dn)
  0x6f, 0x75, 0x3d, 0x50, 0x65, 0x6f, 0x70, 0x6c, // "ou=Peopl"
  0x65, 0x2c, 0x20, 0x64, 0x63, 0x3d, 0x65, 0x78, // "e, dc=ex"
  0x61, 0x6d, 0x70, 0x6c, 0x65, 0x2c, 0x20, 0x64, // "ample, d"
  0x63, 0x3d, 0x63, 0x6f, 0x6d, // "c=com"

  0x04, 0x73, // octet string, 115 bytes (diagnostic message)
  // "Entry uid=missing1, ou=missing2, ou=People, dc=example, dc=com cannot be
  // created because its parent does not exist."
  0x45, 0x6e, 0x74, 0x72, 0x79, 0x20, 0x75, 0x69,
  0x64, 0x3d, 0x6d, 0x69, 0x73, 0x73, 0x69, 0x6e,
  0x67, 0x31, 0x2c, 0x20, 0x6f, 0x75, 0x3d, 0x6d,
  0x69, 0x73, 0x73, 0x69, 0x6e, 0x67, 0x32, 0x2c,
  0x20, 0x6f, 0x75, 0x3d, 0x50, 0x65, 0x6f, 0x70,
  0x6c, 0x65, 0x2c, 0x20, 0x64, 0x63, 0x3d, 0x65,
  0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x2c, 0x20,
  0x64, 0x63, 0x3d, 0x63, 0x6f, 0x6d, 0x20, 0x63,
  0x61, 0x6e, 0x6e, 0x6f, 0x74, 0x20, 0x62, 0x65,
  0x20, 0x63, 0x72, 0x65, 0x61, 0x74, 0x65, 0x64,
  0x20, 0x62, 0x65, 0x63, 0x61, 0x75, 0x73, 0x65,
  0x20, 0x69, 0x74, 0x73, 0x20, 0x70, 0x61, 0x72,
  0x65, 0x6e, 0x74, 0x20, 0x64, 0x6f, 0x65, 0x73,
  0x20, 0x6e, 0x6f, 0x74, 0x20, 0x65, 0x78, 0x69,
  0x73, 0x74, 0x2e
]

/**
 * Represents an ADD response with referrals.
 * Taken from https://web.archive.org/web/20220630073105/https://nawilson.com/ldapv3-wire-protocol-reference-add/
 */
module.exports.addResponseReferralsBytes = [
  0x30, 0x81, 0xcf, // sequence, 207 bytes
  0x02, 0x01, 0x03, // message id 3
  0x69, 0x81, 0xc9, // add response op, 201 bytes
  0x0a, 0x01, 0x0a, // referral result code (enumerated value 10)
  0x04, 0x00, // no matched dn (0-byte octet string)

  0x04, 0x2f, // octet string, 47 bytes (diagnostic message)
  // "This server is read-only. Try a different one."
  0x54, 0x68, 0x69, 0x73, 0x20, 0x73, 0x65, 0x72,
  0x76, 0x65, 0x72, 0x20, 0x69, 0x73, 0x20, 0x72,
  0x65, 0x61, 0x64, 0x2d, 0x6f, 0x6e, 0x6c, 0x79,
  0x2e, 0x20, 0x20, 0x54, 0x72, 0x79, 0x20, 0x61,
  0x20, 0x64, 0x69, 0x66, 0x66, 0x65, 0x72, 0x65,
  0x6e, 0x74, 0x20, 0x6f, 0x6e, 0x65, 0x2e,

  0xa3, 0x81, 0x90, // referrals sequence, 144 bytes
  0x04, 0x46, // string, 70 bytes (first url)
  // "ldap://alternate1.example.com:389/uid=jdoe,ou=Remote,dc=example,dc=com"
  0x6c, 0x64, 0x61, 0x70, 0x3a, 0x2f, 0x2f, 0x61,
  0x6c, 0x74, 0x65, 0x72, 0x6e, 0x61, 0x74, 0x65,
  0x31, 0x2e, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c,
  0x65, 0x2e, 0x63, 0x6f, 0x6d, 0x3a, 0x33, 0x38,
  0x39, 0x2f, 0x75, 0x69, 0x64, 0x3d, 0x6a, 0x64,
  0x6f, 0x65, 0x2c, 0x6f, 0x75, 0x3d, 0x52, 0x65,
  0x6d, 0x6f, 0x74, 0x65, 0x2c, 0x64, 0x63, 0x3d,
  0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x2c,
  0x64, 0x63, 0x3d, 0x63, 0x6f, 0x6d,

  0x04, 0x46, // string, 70 bytes (second url)
  // "ldap://alternate2.example.com:389/uid=jdoe,ou=Remote,dc=example,dc=com"
  0x6c, 0x64, 0x61, 0x70, 0x3a, 0x2f, 0x2f, 0x61,
  0x6c, 0x74, 0x65, 0x72, 0x6e, 0x61, 0x74, 0x65,
  0x32, 0x2e, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c,
  0x65, 0x2e, 0x63, 0x6f, 0x6d, 0x3a, 0x33, 0x38,
  0x39, 0x2f, 0x75, 0x69, 0x64, 0x3d, 0x6a, 0x64,
  0x6f, 0x65, 0x2c, 0x6f, 0x75, 0x3d, 0x52, 0x65,
  0x6d, 0x6f, 0x74, 0x65, 0x2c, 0x64, 0x63, 0x3d,
  0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x2c,
  0x64, 0x63, 0x3d, 0x63, 0x6f, 0x6d
]

/**
 * Represents an ADD request with attributes.
 * Taken from https://web.archive.org/web/20220630073105/https://nawilson.com/ldapv3-wire-protocol-reference-add/
 */
module.exports.addRequestBytes = [
  0x30, 0x49, // start sequence, 73 bytes
  0x02, 0x01, 0x02, // message id 2
  0x68, 0x44, // add op, 68 bytes

  0x04, 0x11, // entry dn string, 17 bytes
  0x64, 0x63, 0x3d, 0x65, // "dc=example,dc=com"
  0x78, 0x61, 0x6d, 0x70,
  0x6c, 0x65, 0x2c, 0x64,
  0x63, 0x3d, 0x63, 0x6f,
  0x6d,

  0x30, 0x2f, // start attributes sequence, 47 bytes
  0x30, 0x1c, // start first attribute sequence, 28 bytes

  0x04, 0x0b, // string, 11 bytes
  0x6f, 0x62, 0x6a, 0x65, // "objectclass"
  0x63, 0x74, 0x63, 0x6c,
  0x61, 0x73, 0x73,
  0x31, 0x0d, // start value sequence, 13 bytes
  0x04, 0x03, 0x74, 0x6f, 0x70, // string: "top"
  0x04, 0x06, 0x64, 0x6f, 0x6d, 0x61, 0x69, 0x6e, // string: "domain"

  0x30, 0x0f, // start second attribute sequence, 15 bytes
  0x04, 0x02, 0x64, 0x63, // string: "dc"
  0x31, 0x09, // start second value sequence, 9 bytes
  0x04, 0x07, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65 // string: "example"
]

/**
 * Represents an LDAP Bind Request Message as defined by
 * RFC 4511 ยง4.2. It has a message id of "1" and attempts to bind
 * with simple authentication as user "uid=admin,ou=sys" with the password
 * "secret".
 */
module.exports.bindRequestBytes = [
  0x30, 0x25, // sequence, 37 bytes
  0x02, 0x01, 0x01, // message id (integer value "1")
  0x60, 0x20, // protocol op (0x60), 32 bytes
  0x02, 0x01, 0x03, // version (integer value "3")
  0x04, 0x13, // string, 19 bytes
  0x75, 0x69, 0x64, 0x3d, // "uid="
  0x61, 0x64, 0x6d, 0x69, 0x6e, 0x2c, // "admin,"
  0x6f, 0x75, 0x3d, 0x73, 0x79, 0x73, // "ou=sys"
  0x74, 0x65, 0x6d, // "tem"
  0x80, 0x06, // auth choice 0 ("simple"), 6 bytes
  0x73, 0x65, 0x63, 0x72, 0x65, 0x74 // "secret"
]

/**
 * Represents an anonymous bind request.
 */
module.exports.bindRequestAnonymousBytes = [
  0x30, 0x0c,
  0x02, 0x01, 0x01,
  0x60, 0x07,
  0x02, 0x01, 0x03,
  0x04, 0x00,
  0x80, 0x00
]

/**
 * Represents a delete request with controls supplied for recursive removal.
 * Taken from https://web.archive.org/web/20220629203240/https://ldap.com/ldapv3-wire-protocol-reference-ldap-message/#ldapmessage-example
 */
module.exports.deleteRequestBytes = [
  0x30, 0x35, // start sequence, 53 bytes
  0x02, 0x01, 0x05, // message id 5
  0x4a, 0x11, // delete request op (entry), 17 bytes
  0x64, 0x63, 0x3d, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, // dc=exampl
  0x65, 0x2c, 0x64, 0x63, 0x3d, 0x63, 0x6f, 0x6d, // e,dc=com

  0xa0, 0x1d, // start sequence (controls), 29 bytes
  0x30, 0x1b, // start first control sequence, 27 bytes
  0x04, 0x16, 0x31, 0x2e, // control OID (octet string):
  0x32, 0x2e, 0x38, 0x34, // 1.2.840.113556.1.4.805
  0x30, 0x2e, 0x31, 0x31,
  0x33, 0x35, 0x35, 0x36,
  0x2e, 0x31, 0x2e, 0x34,
  0x2e, 0x38, 0x30, 0x35,
  0x01, 0x01, 0xff // control criticality (boolean true)
]
